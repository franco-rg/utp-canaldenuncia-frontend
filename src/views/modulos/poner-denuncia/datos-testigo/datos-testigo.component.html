<section>
  <h2 class="text-2xl font-semibold mb-6 text-gray-600">Testigo</h2>

  <form [formGroup]="formDatosTestigo" class="space-y-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-gray-700 font-medium mb-1">Nombre</label>
        <input invalid type="text" formControlName="NombreTestigo" placeholder="Nombre" class="w-full border p-2 rounded outline-none">
        <div 
          *ngIf="formDatosTestigo.get('NombreTestigo')?.invalid && (formDatosTestigo.get('NombreTestigo')?.dirty || formDatosTestigo.get('NombreTestigo')?.touched)" 
          class="text-red-500 text-sm mt-1"
        >
          <div *ngIf="formDatosTestigo.get('NombreTestigo')?.errors?.['pattern']">
            Solo se permiten letras y espacios.
          </div>
        </div>
      </div>
      <div>
        <label class="block text-gray-700 font-medium mb-1">Apellidos</label>
        <input type="text" formControlName="ApellidosTestigo" placeholder="Apellidos" class="w-full border p-2 rounded outline-none">
        <div 
          *ngIf="formDatosTestigo.get('ApellidosTestigo')?.invalid && (formDatosTestigo.get('ApellidosTestigo')?.dirty || formDatosTestigo.get('ApellidosTestigo')?.touched)" 
          class="text-red-500 text-sm mt-1"
        >
          <div *ngIf="formDatosTestigo.get('ApellidosTestigo')?.errors?.['pattern']">
            Solo se permiten letras y espacios.
          </div>
        </div>
      </div>
      <div>
        <label class="block text-gray-700 font-medium mb-1">Correo</label>
        <input type="email" formControlName="CorreoTestigo" placeholder="Correo" class="w-full border p-2 rounded outline-none">
      </div>
      <div>
        <label class="block text-gray-700 font-medium mb-1">Teléfono</label>
        <input type="tel" formControlName="TelefonoTestigo" placeholder="Teléfono" class="w-full border p-2 rounded outline-none">
      </div>
    </div>
    <div class="relative">
      <label class="block text-gray-700 font-medium mb-1">Comentarios</label>
      <textarea formControlName="ComentariosTestigo" rows="5" placeholder="Comentarios" class="w-full border p-2 rounded outline-none"></textarea>
      <p class="text-gray-500 text-sm mt-1">
        {{ formDatosTestigo.controls['ComentariosTestigo'].value?.length || "0" }}/4000 caracteres
      </p>
    </div>
    <div class="m-auto">
        <button (click)="agregarTestigo()" [disabled]="formDatosTestigo.invalid" type="button" class="p-3 text-white rounded-xl disabled:bg-gray-400 bg-gray-600 hover:bg-gray-700">
          Añadir testigo
        </button>
    </div>
  </form>

  <div *ngIf="testigos.length" class="relative overflow-x-auto sm:rounded-lg mt-4">
    <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
        <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
          <tr>
            <th class="p-4">Nombre</th>
            <th class="p-4">Apellidos</th>
            <th class="p-4">Correo</th>
            <th class="p-4">Teléfono</th>
            <th class="p-4">Comentarios</th>
            <th class="p-4">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let testigo of testigos, let i = index">
            <td class="p-2">{{ testigo?.nombre }}</td>
            <td class="p-2">{{ testigo?.apellidos }}</td>
            <td class="p-2">{{ testigo?.correo }}</td>
            <td class="p-2">{{ testigo?.telefono }}</td>
            <td class="p-2">{{ testigo?.comentarios }}</td>
            <td class="p-2">
                <div class="flex justify-center items-center">
                    <button (click)="eliminarTestigo(i)" type="button" class="p-3 text-white rounded-xl disabled:bg-gray-400 bg-gray-600 hover:bg-gray-700">
                      <i class="fa-solid fa-trash-can"></i>
                    </button>
                </div>
            </td>
          </tr>
      </table>
  </div>
</section>